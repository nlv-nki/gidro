function changeView(e){"line"==e&&(console.log("sw line"),$(".product__item").addClass("product__item--line")),"grid"==e&&(console.log("sw line"),$(".product__item").removeClass("product__item--line"))}$(document).ready((function(){new Swiper(".promo__slider-container",{loop:!0,slidesPerView:1,spaceBetween:30,freeMode:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})})),$(document).ready((function(){$(".search__tabs-item").on("click",(function(e){e.preventDefault(),$(".search__tabs-item").removeClass("search__tabs-item--active"),$(".search__content-item").removeClass("search__content-item--active"),$(this).addClass("search__tabs-item--active"),console.log($($(this).attr("href"))),$($(this).attr("href")).addClass("search__content-item--active")}))})),$(document).ready((function(){$(".tabs__item").on("click",(function(e){e.preventDefault(),console.log($(this).closest("div").next().find(".tabs__content-item")),$(this).closest("ul").find(".tabs__item").removeClass("tabs__item--active"),$(this).closest("div").next().find(".tabs__content-item").removeClass("tabs__content-item--active"),$(this).addClass("tabs__item--active"),$($(this).attr("href")).addClass("tabs__content-item--active")}))})),$(document).ready((function(){$(".tabs__item").on("click",(function(e){e.preventDefault(),console.log($(this).closest("div").next().find(".tabs__content-item")),$(this).closest("ul").find(".tabs__item").removeClass("tabs__item--active"),$(this).closest("div").next().find(".tabs__content-item").removeClass("tabs__content-item--active"),$(this).addClass("tabs__item--active"),$($(this).attr("href")).addClass("tabs__content-item--active")}))})),$(document).ready((function(){$(".product__favorites").on("click",(function(e){console.log(123),$(this).hasClass("product__favorites--active")?$(this).removeClass("product__favorites--active"):$(this).addClass("product__favorites--active")}))})),$(document).ready((function(){$(".products-filter__content input").styler(),$(".products-filter__option-item select").styler(),$(".products-filter__drop-item-title").on("click",(function(e){$(this).toggleClass("products-filter__drop-item-title--active"),$(this).next().slideToggle()}));var e,t=$(".js-range-slider"),i=$(".js-input-from"),s=$(".js-input-to"),n=1e5,o=4e6;function r(e){n=e.from,o=e.to,i.prop("value",n),s.prop("value",o)}t.ionRangeSlider({skin:"round",type:"double",min:1e5,max:4e6,from:n,to:o,grid:!1,force_edges:!0,hide_min_max:!0,hide_from_to:!0,block:!1,onStart:r,onChange:r}),e=t.data("ionRangeSlider"),i.on("input",(function(){var t=$(this).prop("value");t<1e5?t=1e5:t>o&&(t=o),e.update({from:t}),console.log(e,777)})),s.on("input",(function(){var t=$(this).prop("value");t<n?t=n:t>4e6&&(t=4e6),e.update({to:t})}))}));class ProductFilter{constructor({filters:e,products:t}){this.filters=e,this.products=t,this._subscribe()}_subscribe(){this.filters.addEventListener("click",e=>{e.target.closest(".products-filter__submit-btn")&&(this.productsCollection(),this.filter())})}productsCollection(){return Object.fromEntries(Array.from(this.products).map((e,t,i)=>{let s,n=!0;return e.querySelector(".product__not-available").classList.contains("product__not-available--active")&&(n=!1,s=!0),["productId-"+e.dataset.productId,{productTitle:e.querySelector(".product__title a").innerText,productPrice:e.querySelector(".product__price-current").innerText,productAvalible:n,productOrder:s,productId:"productId-"+e.dataset.productId,element:i[t]}]}))}filter(){let e=this.productsCollection(),t=Array.from(this.filters).filter(e=>{if("checkbox"==e.type&&1==e.checked)return e}),i={min:+document.querySelector(".js-input-from").value,max:+document.querySelector(".js-input-to").value};t.forEach(t=>{Object.keys(e).forEach((function(i){e[i][t.name]||e[i][t.name]||(e[i].element.hidden=!0,e[i].element.style.display="none")}))}),Object.keys(e).forEach((function(t){console.log(i.max,999);let s=+e[t].productPrice.split(" ").join("").slice(0,-1);console.log(s,"price "+i.max+"max"),(s<i.min||s>i.max)&&(e[t].element.style.display="none")})),this.products.forEach(e=>{e.querySelector(".product__title a").innerText.includes(this.filters.freeSearchByModel.value)||(e.style.display="none")})}}new ProductFilter({filters:document.querySelector(".products-filter__form"),products:document.querySelectorAll(".product__item")}),$(document).ready((function(){new Swiper(".popular-goods__slider-container",{loop:!0,slidesPerView:"auto",spaceBetween:30,freeMode:!0,breakpoints:{320:{slidesPerView:1,spaceBetween:20},765:{slidesPerView:2,spaceBetween:15},960:{slidesPerView:3,spaceBetween:30},1200:{slidesPerView:4,spaceBetween:40}},navigation:{nextEl:".popular-goods__swiper-button-next",prevEl:".popular-goods__swiper-button-prev"}})})),$(document).ready((function(){new Swiper(".new-items__slider-container",{loop:!0,slidesPerView:"auto",spaceBetween:30,freeMode:!0,breakpoints:{320:{slidesPerView:1,spaceBetween:20},765:{slidesPerView:2,spaceBetween:15},960:{slidesPerView:3,spaceBetween:30},1200:{slidesPerView:4,spaceBetween:40}},navigation:{nextEl:".new-items__swiper-button-next",prevEl:".new-items__swiper-button-prev"}})})),$(document).ready((function(){$(".catalog__sorting-select").styler(),$(".catalog__view-btn").on("click",(function(e){$(this).hasClass("catalog__view-btn--active")||($(".catalog__view-btn--active").removeClass("catalog__view-btn--active"),$(this).addClass("catalog__view-btn--active"))}))})),$((function(){$("#product-page__star-rate").rateYo({normalFill:"#C4C4C4",ratedFill:"#1C62CD",rating:"50%",starWidth:"23px"})}));var menu=document.querySelector(".mobile-menu__list"),menuBtn=document.querySelector(".humburger__btn");console.log(menuBtn),menuBtn.addEventListener("click",()=>{console.log("1"),menuBtn.classList.contains("is-active")?(menuBtn.classList.remove("is-active"),menu.style.display="none"):(menu.style.display="flex",console.log(menuBtn.style.marginTop),menuBtn.classList.add("is-active"),menu.classList.add("is-active"))},!1);menu=document.querySelector(".mobile-menu__list"),menuBtn=document.querySelector(".humburger__btn");console.log(menuBtn),menuBtn.addEventListener("click",()=>{console.log("1"),menuBtn.classList.contains("is-active")?(menuBtn.classList.remove("is-active"),menu.style.display="none"):(menu.style.display="flex",console.log(menuBtn.style.marginTop),menuBtn.classList.add("is-active"),menu.classList.add("is-active"))},!1);class Cart{constructor({elem:e}){this.elem=e,console.log("new Cart loaded"),this.bucket={},this._onClick(),this.render()}_onClick(){document.addEventListener("click",e=>{if(e.target.closest(".product__btn")){let t=e.target.closest(".product__item"),i=t.querySelector(".product__title a").innerText,s=t.querySelector(".product__price-current").innerText,n="productId-"+t.dataset.productId;this.addItem(n,i,s)}})}_createItem(e,t,i){return{id:e,name:t,cost:i,quantity:1}}_getBasket(){return JSON.parse(localStorage.getItem("cart"))}_getItem(e){return JSON.parse(localStorage.getItem("cart"))[e]}addItem(e,t,i){this.basket=localStorage.getItem("cart")?this.basket=JSON.parse(localStorage.getItem("cart")):this.basket={},this.basket[e]?this.basket[e].quantity++:this.basket[e]=this._createItem(e,t,i),localStorage.setItem("cart",JSON.stringify(this.basket)),this.render()}removeItem(e){let t=this._getBasket();console.log(t),console.log(e),console.log(t[e],666),t[e].quantity>1?(t[e].quantity--,console.log("quan "+t[e].quantity),this.render()):delete t[e],console.log(t),console.log(Object.keys(t).length,777),localStorage.setItem("cart",JSON.stringify(t)),this.render()}render(){let e=document.querySelector(".basket"),t=document.querySelector(".basket__num"),i=this._getBasket(),s=0,n=document.querySelector(".mini-cart");e.append(n),n.innerHTML="",i&&Object.keys(i).forEach(e=>{s+=i[e].quantity,s&&(t.style.display="inline-block",t.innerText=s),n.innerHTML+=`\n        <div class="mini-cart__item">\n            <div><span class="mini-cart__price">Модель: ${i[e].name}</span></div>\n            <div>Артикул:<span class="mini-cart__id">${i[e].id}</span></div>\n            <div><span class="mini-cart__price">Цена:  ${i[e].cost}</span></div>\n            <div class="mini-cart__summary"><span class="mini-cart__quantity">Количество: ${i[e].quantity}</span><span class="mini-cart__remove-item">Удалить</span></div>\n          </div>\n        `}),0===s&&(t.style.display="none")}}let timer,cart=new Cart({elem:document.querySelector(".product__item")}),basket=document.querySelector(".basket"),trigger=!1;function show(){miniCart.style.display="block",miniCart.classList.add("is-active"),clearTimeout(timer)}function hide(){miniCart.style.display="none",miniCart.classList.remove("is-active")}miniCart=document.querySelector(".mini-cart"),miniCart.addEventListener("mouseover",e=>trigger=!0),miniCart.addEventListener("mouseout",e=>hide()),basket.addEventListener("mouseover",e=>show()),basket.addEventListener("mouseout",e=>{trigger||(timer=setTimeout(e=>{miniCart.style.display="none",miniCart.classList.remove("is-active")},5e3),console.log("basket timer on"))});class MiniCart{constructor({elem:e}){this._elem=e,this._subscribe()}_subscribe(){this._elem.addEventListener("click",(function(e){if(e.target.closest(".mini-cart__remove-item")){console.log(e.target.closest(".mini-cart__item").querySelector(".mini-cart__id").innerHTML);let t=e.target.closest(".mini-cart__item").querySelector(".mini-cart__id").innerHTML;cart.removeItem(t)}}))}}new MiniCart({elem:document.querySelector(".mini-cart")}),console.log("all block loaded");